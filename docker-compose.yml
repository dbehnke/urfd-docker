services:
  urfd:
    build:
      context: .
      dockerfile: Dockerfile
    image: urfd-combined
    container_name: urfd
    command: urfd
    network_mode: host
    volumes:
      - ./config:/usr/local/etc/urfd:ro
      - urfd_logs:/var/log/urfd
      - urfd_audio:/usr/local/bin/audio
    restart: unless-stopped

  tcd:
    image: urfd-combined
    container_name: tcd
    command: tcd
    network_mode: host
    depends_on:
      - urfd
    volumes:
      - ./config:/usr/local/etc/tcd:ro
    restart: unless-stopped

  dashboard:
    image: urfd-combined
    container_name: dashboard
    command: dashboard
    network_mode: host
    environment:
      - URFD_HOST=localhost
      - URFD_AUDIO_PATH=/usr/local/bin/audio
    depends_on:
      - urfd
    volumes:
      - urfd_audio:/usr/local/bin/audio
    restart: unless-stopped

volumes:
  urfd_logs:
  urfd_audio:
